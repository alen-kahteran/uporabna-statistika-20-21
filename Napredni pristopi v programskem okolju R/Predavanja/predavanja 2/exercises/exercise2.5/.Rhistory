boxplot(my.data$S.~my.data$Abstinence.12all)
names(my.data)
boxplot(my.data$R.~my.data$Abstinence.12all)
boxplot(my.data$R.~my.data$Abstinence.3)
boxplot(my.data$C.~my.data$Abstinence.3)
boxplot(my.data$M.~my.data$Abstinence.3)
t.test(my.data$M.~my.data$Abstinence.3)
t.test(my.data$C.~my.data$Abstinence.3)
t.test(my.data$R.~my.data$Abstinence.3)
wilcox.test(my.data$R.~my.data$Abstinence.3)
wilcox.test(my.data$C.~my.data$Abstinence.3)
wilcox.test(my.data$M.~my.data$Abstinence.3)
wilcox.test(my.data$M.~my.data$Abstinence.36
wilcox.test(my.data$M.~my.data$Abstinence.6)
wilcox.test(my.data$M.~my.data$Abstinence.12)
boxplot(my.data$M.~my.data$Abstinence.12)
boxplot(my.data$M.~my.data$Abstinence.12all)
wilcox.test(my.data$M.~my.data$Abstinence.12all)
t.test(my.data$M.~my.data$Abstinence.12all)
qplot(data=my.data.all, x=factor(Time), y=Abstinence,  geom=c("boxplot"), binwidth=5, xlab="Time")
qplot(data=my.data.all, x=factor(Time), y=Abstinence,  binwidth=5, xlab="Time")
qplot(data=my.data.all, x=factor(Time), y=Abstinence,  geom=c("bar"), binwidth=5, xlab="Time")
qplot(data=my.data.all, x=factor(Abstinence), geom=c("bar"), binwidth=5, xlab="Time")
qplot(data=my.data.all, x=factor(Abstinence), geom=c("bar"))
qplot(data=my.data.all, x=factor(Abstinence), geom=c("bar"), facets=~Time)
qplot(data=my.data.all, x=factor(Abstinence), geom=c("bar"), facets=~Time, xlab="Abstinence")
names(my.data.all)
qplot(data=my.data.all, x=factor(Abstinence), geom=c("bar"), facets=Abstinence~Time, xlab="Abstinence")
qplot(data=my.data.all, x=factor(Heroin), geom=c("bar"), facets=Abstinence~Time, xlab="Heroin")
my.data$Duration
names(my.data)
my.data$Cure.Duration
hist(my.data$Cure.Duration)
hist(my.data$Cure.Duration.Planned-my.data$Cure.Duration)
table(my.data$Cure.Finished)
(my.data$Cure.Finished)
glm(my.data$Cure.Finished~my.data$Sex)
glm(my.data$Cure.Finished~my.data$Sex, family="binomial")
summary(glm(my.data$Cure.Finished~my.data$Sex, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Age, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$C., family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$R., family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$M., family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$C., family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$QoL, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$QoL.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Heroin.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$OtherDrugs.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Drugs.Other.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$IV.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$ST.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Alcohol.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Coc.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Thc.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Bzo.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Heroin.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Abstinence.0, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Nationality.OK, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$HighSchool, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$VirusHC, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$VirusHC.Cure, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$VirusHC, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Mental, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Mental.3cat, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Mental.Mother, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Mental.Father, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Mental.Mother, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Sex.H, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Previous.Cure, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Totla, family="binomial"))
summary(glm(my.data$Cure.Finished~my.data$Total, family="binomial"))
qplot(data=my.data, x=C.external, y=Total)
qplot(data=my.data, x=C.external, y=Totalm geom=c("points", "gam"))
qplot(data=my.data, x=C.external, y=Total, geom=c("points", "gam"))
qplot(data=my.data, x=C.external, y=Total, geom=c("gam"))
qplot(data=my.data, x=C.external, y=Total, geom=c("points", "smooth"))
qplot(data=my.data, x=C.external, y=Total, geom=c("points", "smooth"), method="gam")
qplot(data=my.data, x=C.external, y=Total, geom=c("point", "smooth"), method="gam")
qplot(data=my.data, x=C.external, y=Total, geom=c("point", "smooth"), method="gam", formula=y~s(x, bs="cs"))
library(mgcv)
qplot(data=my.data, x=C.external, y=Total, geom=c("point", "smooth"), method="gam", formula=y~s(x, bs="cs"))
qplot(data=my.data, x=C.external, y=Total, geom=c("point", "jitter" , "smooth"), method="gam", formula=y~s(x, bs="cs"))
qplot(data=my.data, x=M., y=Total, geom=c("point", "jitter" , "smooth"), method="gam", formula=y~s(x, bs="cs"))
names(my.data)
qplot(data=my.data, x=M.motivation, y=Total, geom=c("point", "jitter" , "smooth"), method="gam", formula=y~s(x, bs="cs"))
qplot(data=my.data, x=Age, y=Total, geom=c("point", "jitter" , "smooth"), method="gam", formula=y~s(x, bs="cs"))
qplot(data=my.data, x=Age, y=M.motivation, geom=c("point", "jitter" , "smooth"), method="gam", formula=y~s(x, bs="cs"))
qplot(data=my.data, x=Age, y=R.readiness, geom=c("point", "jitter" , "smooth"), method="gam", formula=y~s(x, bs="cs"))
qplot(data=my.data, x=Age, y=Total, geom=c("point", "jitter" , "smooth"), method="gam", formula=y~s(x, bs="cs"))
qplot(data=my.data, x=Age, y=DATES.0, geom=c("point", "jitter" , "smooth"), method="gam", formula=y~s(x, bs="cs"))
names(my.data)
qplot(data=my.data, x=Age, y=Cure.Duration, geom=c("point", "jitter" , "smooth"), method="gam", formula=y~s(x, bs="cs"))
qplot(data=my.data, x=M.motivation, y=Cure.Duration, geom=c("point", "jitter" , "smooth"), method="gam", formula=y~s(x, bs="cs"))
qplot(data=my.data, x=M.motivation, y=Cure.Duration, geom=c("point", "jitter" , "smooth"))
qplot(data=my.data, x=M.motivation, y=Cure.Duration, geom=c("point", "jitter" , "smooth"), method="loess")
qplot(data=my.data, y=M.motivation, x=Age, geom=c("point", "jitter" , "smooth"), method="loess")
qplot(data=my.data, y=C.external, x=Age, geom=c("point", "jitter" , "smooth"), method="loess")
qplot(data=my.data, y=R.readiness, x=Age, geom=c("point", "jitter" , "smooth"), method="loess")
glm(R.readiness~rcs(Age))
glm(R.readiness~rcs(Age), data=my.data)
anova(glm(R.readiness~rcs(Age), data=my.data))
anova(glm(R.readiness~rcs(Age), data=my.data), test="Chi")
anova(glm(M.motivation~rcs(Age), data=my.data), test="Chi")
anova(glm(C.external~rcs(Age), data=my.data), test="Chi")
glm(my.data$Abstinence.12all~my.data$Cure.Finisher)
glm(my.data$Abstinence.12all~my.data$Cure.Finished)
glm(my.data$Abstinence.12all~my.data$Cure.Finished, family="binomial")
summary(glm(my.data$Abstinence.12all~my.data$Cure.Finished, family="binomial"))
exp(1.76)
table(my.data$Abstinence.12all,my.data$Cure.Finished)
table(Abs12=my.data$Abstinence.12all, CureFinished=my.data$Cure.Finished)
table(Abs12=my.data$Abstinence.12all, CureFinished=my.data$Cure.Finished, exclude=NULL)
my.table0=table(Abs12=my.data$Abstinence.12all, CureFinished=my.data$Cure.Finished, exclude=NULL)
dimnames(my.table0)[[1]]=dimnames(my.table0)[[2]]=c("No", "Yes", "Missing")
my.table8
my.table9
my.table0
my.table0=table(Abs12=my.data$Abstinence.12all, CureFinished=my.data$Cure.Finished, exclude=NULL)
my.table9
my.table0
table(my.data$Abstinence.12all, my.data$Cure.Finished)
chisq.test(table(my.data$Abstinence.12all, my.data$Cure.Finished))
chisq.test(table(my.data$Abstinence.12all, my.data$Cure.Finished, exclude=NULL))
table(my.data$Abstinence.12all, my.data$Cure.Finished, exclude=NULL)
as.matrix(table(my.data$Abstinence.12all, my.data$Cure.Finished, exclude=NULL))
as.matrix(table(my.data$Abstinence.12all, my.data$Cure.Finished, exclude=NULL))[,c(1:2)]
chisq.test(as.matrix(table(my.data$Abstinence.12all, my.data$Cure.Finished, exclude=NULL))[,c(1:2)])
11/15
55/(55+116)
my.table0
my.table0[2,2]/sum(my.table0[,2])
binom.test( my.table0[2,2], sum(my.table0[,2]))
binom.test( my.table0[2,2], sum(my.table0[,2]))$conf.int
binom.test( my.table0[2,2], sum(my.table0[,2]))$conf.int[1]
my.table0
my.data$Psich.Health
my.data$Psich.Health.0
my.data$Psichol.Health.0
my.data$Psich.Health.0
names(my.data)
my.data$Psicic.Health.0
my.data$Psico.Health.0
my.data$Psicho.Health.0
hist(my.data$Psicho.Health.0)
vqplot(my.data$Psicho.Health.0, geom="hist", binwidht=2.5)
qplot(my.data$Psicho.Health.0, geom="hist", binwidht=2.5)
qplot(my.data$Psicho.Health.0, geom="his", binwidht=2.5)
qplot(x=Psicho.Health.0, data=my.data, geom=c("hist"), binwidht=2.5)
qplot(x=Psicho.Health.0, data=my.data, geom=c("histogram
")
qplot(x=Psicho.Health.0, data=my.data, geom=c("histogram"), binwidht=2.5)
qplot(x=Psicho.Health.0, data=my.data, geom=c("histogram"), binwidht=5)
qplot(x=Psicho.Health.0, data=my.data, geom=c("histogram"), binwidth=5)
qplot(x=Psicho.Health.0, data=my.data, geom=c("histogram"), binwidth=2.5)
names(my.data)
glm(Abstinence.12all~Psicho.Health.0, family="binomial")
glm(Abstinence.12all~Psicho.Health.0, family="binomial", data=my.data)
summary(glm(Abstinence.12all~Psicho.Health.0, family="binomial", data=my.data))
summary(glm(Abstinence.12all~rcs(Psicho.Health.0), family="binomial", data=my.data))
anova(glm(Abstinence.12all~rcs(Psicho.Health.0), family="binomial", data=my.data))
anova(glm(Abstinence.12all~rcs(Psicho.Health.0), family="binomial", data=my.data), test="Chi")
anova(glm(Abstinence.12all~rcs(Psicho.Health.0), family="binomial", data=my.data, x=T, y=T))
tmp=glm(Abstinence.12all~rcs(Psicho.Health.0), family="binomial", data=my.data, x=T, y=T)
plot(tmp$fitted)
plot(tmp$x[,2], tmp$fitted)
tmp=glm(Abstinence.12all~rcs(Psicho.Health.0), family="binomial", data=my.data, x=T, y=T)
summary(tmp)
tmp=glm(Abstinence.0~rcs(Psicho.Health.0), family="binomial", data=my.data, x=T, y=T)
summary(tmp)
anova(tmp)
anova(tmp, test="Chi")
plot(tmp$x[,2], tmp$fitted)
tmp=glm(Abstinence.3~rcs(Psicho.Health.0), family="binomial", data=my.data, x=T, y=T)
plot(tmp$x[,2], tmp$fitted)
tmp=glm(Abstinence.6~rcs(Psicho.Health.0), family="binomial", data=my.data, x=T, y=T)
plot(tmp$x[,2], tmp$fitted)
tmp=glm(Abstinence.12~rcs(Psicho.Health.0), family="binomial", data=my.data, x=T, y=T)
plot(tmp$x[,2], tmp$fitted)
tmp=glm(Abstinence.0~rcs(Psicho.Health.0), family="binomial", data=my.data, x=T, y=T)
plot(tmp$x[,2], tmp$fitted)
tmp=glm(Abstinence.12all~rcs(Psicho.Health.0), family="binomial", data=my.data, x=T, y=T)
plot(tmp$x[,2], tmp$fitted)
Surv(Abstinence.Time, Abstinence.Event)
library(Surv)
library(survival)
Surv(Abstinence.Time, Abstinence.Event)
Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)
survfir(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~my.data$Psicho.Health.0)
survfit(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~my.data$Psicho.Health.0)
survfit(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~as.numeric(my.data$Psicho.Health.0))
coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~as.numeric(my.data$Psicho.Health.0))
coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~I(my.data$Psicho.Health.0>10))
coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~I(my.data$Psicho.Health.0>15))
my.data$Psicho.Health.0
summary(my.data$Psicho.Health.0)
coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~I(my.data$Psicho.Health.0>10))
coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~I(my.data$Psicho.Health.0>=10))
coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~I(my.data$Psicho.Health.0>=5))
coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~rcs(my.data$Psicho.Health.0>=5))
coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~rcs(my.data$Psicho.Health.0))
tmp=coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~rcs(my.data$Psicho.Health.0))
anova(tmp)
tmp=glm(my.data$Abstinence.12all~rcs(my.data$Psicho.Health.0))
tmp=glm(my.data$Abstinence.12all~rcs(my.data$Psicho.Health.0), family="binomial")
anova(tmp)
anova(tmp, test="Chi")
tmp=glm(my.data$Abstinence.12all~rcs(my.data$Psicho.Health.0), family="binomial", x=T, y=T)
plot(tmp$x[,2], tmp$fitted)
wilcox.test(my.data$Psicho.Health.0~my.data$Abstinence.12all)
boxplot(my.data$Psicho.Health.0~my.data$Abstinence.12all)
qplot(data=my.data.all[!is.na(my.data.all$Abstinence),], x=factor(Time), y=Psicho.Health,  geom=c("boxplot"), binwidth=5, xlab="Time", facets=~Abstinence)
qplot(data=my.data, x=factor(Abstinence), y=Psicho.Health,  geom=c("boxplot"), binwidth=5, xlab="Time", facets=~Abstinence)
qplot(data=my.data, x=factor(Abstinence), y=Psicho.Health.0,  geom=c("boxplot"), binwidth=5, xlab="Time")
qplot(data=my.data, x=factor(Abstinence.0), y=Psicho.Health.0,  geom=c("boxplot"), binwidth=5, xlab="Time")
qplot(data=my.data.all[!is.na(my.data.all$Abstinence),], x=factor(Time), y=Psicho.Health,  geom=c("boxplot"), binwidth=5, xlab="Time", facets=Abstinence~)
qplot(data=my.data.all[!is.na(my.data.all$Abstinence),], x=factor(Time), y=Psicho.Health,  geom=c("boxplot"), binwidth=5, xlab="Time", facets=Abstinence~.)
qplot(data=my.data.all[!is.na(my.data.all$Abstinence),], x=factor(Abstinence), y=Psicho.Health,  geom=c("boxplot"), binwidth=5, xlab="Time", facets=Time~.)
qplot(data=my.data.all[!is.na(my.data.all$Abstinence),], x=factor(Abstinence), y=Psicho.Health,  geom=c("boxplot"), binwidth=5, xlab="Abstinence at given time", facets=Time~.)
qplot(data=my.data, x=factor(Abstinence.0), y=Psicho.Health.0,  geom=c("boxplot"), binwidth=5, xlab="Time")
qplot(data=my.data, x=factor(Abstinence.12all), y=Psicho.Health.0,  geom=c("boxplot"), binwidth=5, xlab="Abstinence during 12 months")
wilcox.test( my.data$Psicho.Health.0~my.data$Abstinence.0)
wilcox.test( my.data$Psicho.Health.0~my.data$Abstinence.3)
wilcox.test( my.data$Psicho.Health.3~my.data$Abstinence.3)
wilcox.test( my.data$Psicho.Health.6~my.data$Abstinence.6)
wilcox.test( my.data$Psicho.Health.12~my.data$Abstinence.12)
qplot(data=my.data.all[!is.na(my.data.all$Abstinence),], x=factor(Abstinence), y=Phisic.Health,  geom=c("boxplot"), binwidth=5, xlab="Abstinence at given time", facets=Time~.)
tmp=glm(my.data$Abstinence.12all~rcs(my.data$Phisic.Health.0), family="binomial", x=T, y=T)
summary(tmp)
anova(tmp)
anova(tmp, test="Chi")
tmp=coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~rcs(my.data$Psicho.Health.0))
tmp=coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~rcs(my.data$Phisic.Health.0))
summary(tmp)
anova(tmp)
tmp=coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~my.data$Virus.HC)
tmp=coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~my.data$VirusHC)
summary(tmp)
my.table0=table(Abs12=my.data$Abstinence.12all,VirusHC=my.data$VirusHC, exclude=NULL)
dimnames(my.table0)[[1]]=c("Abstinence 12m: No", "Abstinence 12m: Yes", "Missing")
dimnames(my.table0)[[2]]=c("HC Virus: No", "HC virus: Yes", "Missing")
my.table=xtable(my.table0)
print(my.table, type="html")
library(xtable)
my.table0=table(Abs12=my.data$Abstinence.12all,VirusHC=my.data$VirusHC, exclude=NULL)
my.table0
16/57
50/(50+89)
50/(50+89+10)
16/47
16/(16+31)
tmp=coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~my.data$VirusHC)
summary(tmp)
survfir(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~my.data$VirusHC)
survfit(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~my.data$VirusHC)
survdiff(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~my.data$VirusHC)
chisq.test(table(my.data$Abstinence.0,  my.data$VirusHC))
chisq.test(table(my.data$Abstinence.3,  my.data$VirusHC))
chisq.test(table(my.data$Abstinence.6,  my.data$VirusHC))
chisq.test(table(my.data$Abstinence.12,  my.data$VirusHC))
table(my.data$Abstinence.0,  my.data$VirusHC)
prop.table(table(my.data$Abstinence.0,  my.data$VirusHC),2)
qplot(data=my.data, x=factor(Abstinence.12all), y=M.motivation,  geom=c("boxplot"), binwidth=5, xlab="Abstinence during 12 months")
wilcox.test( my.data$M.motivation~my.data$Abstinence.12all)
qplot(data=my.data, x=factor(Abstinence.12all), y=M.motivation,  geom=c("boxplot"), binwidth=5, xlab="Abstinence during 12 months")
qplot(data=my.data, x=factor(Abstinence.0), y=M.motivation,  geom=c("boxplot"), binwidth=5, xlab="Abstinence T=0")
names(my.data)
glm(my.data$Abstinence.12all~my.data$M.motivation)
glm(my.data$Abstinence.12all~my.data$M.motivation, family="binomial")
summary(glm(my.data$Abstinence.12all~my.data$M.motivation, family="binomial"))
tmp=glm(my.data$Abstinence.12all~my.data$M.motivation, family="binomial")
tmp1=glm(my.data$Abstinence.12all~rcs(my.data$M.motivation), family="binomial")
anova(tmp1, tmp)
anova(tmp1, tmp, test="Chi")
tmp=glm(my.data$Abstinence.12all~my.data$M.motivation, family="binomial")
survfit(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~my.data$M.motivation)
coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~my.data$M.motivation)
summary(coxph(Surv(my.data$Abstinence.Time, my.data$Abstinence.Event)~my.data$M.motivation))
glm(Abstinence.12all~M.motivation+C.+R., data=my.data, family="binomial")
names(my.data)
glm(Abstinence.12all~M.motivation+C.external+R.readiness, data=my.data, family="binomial")
summary(glm(Abstinence.12all~M.motivation+C.external+R.readiness, data=my.data, family="binomial"))
summary(glm(Abstinence.12all~M.motivation+Total, data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Total, data=my.data, family="binomial"))
qplot(data=my.data, x=factor(Abstinence.12all), y=M.motivation,  geom=c("boxplot"), binwidth=5, xlab="Abstinence during 12 months")
qplot(data=my.data, x=factor(Abstinence.12all), y=M.motivation,  geom=c("boxplot"), binwidth=5, xlab="Abstinence T=0")
qplot(data=my.data, x=factor(Abstinence.12all), y=M.motivation,  geom=c("boxplot"), binwidth=5, xlab="Abstinence during 12 months")
qplot(data=my.data, x=factor(Abstinence.12all), y=M.motivation,  geom=c("boxplot"), binwidth=5, xlab="Abstinence T=12all")
table(Abstinence.12all)
table(my.data$Abstinence.12all)
names(my.data)
names(my.data)[1:10]
names(my.data)[1:20]
summary(glm(Abstinence.12all~Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Home.0, data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Home0, data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0, data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Heroin.0+Drugs.Other.0, data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Heroin.0+Drugs.Other.0+ST.0, data=my.data, family="binomial"))
table(my.data$Heroin.0, my.data$ST.0)
table(H=my.data$Heroin.0, my.data$ST.0)
table(H=my.data$Heroin.0, ST=my.data$ST.0)
addmargins(table(H=my.data$Heroin.0, ST=my.data$ST.0)_
addmargins(table(H=my.data$Heroin.0, ST=my.data$ST.0))
table(H=my.data$Heroin.0, ST=my.data$ST.0, Abstinence.12all)
table(H=my.data$Heroin.0, ST=my.data$ST.0, my.data$Abstinence.12all)
table(ST=my.data$ST.0, my.data$Abstinence.12all)
prop.table(table(ST=my.data$ST.0, my.data$Abstinence.12all),1)
prop.table(table(ST=my.data$Heroin.0, my.data$Abstinence.12all),1)
prop.table(table(ST=my.data$Heroin.0, my.data$Abstinence.12all, my.data$ST.0),1)
prop.table(table(H=my.data$Heroin.0, my.data$Abstinence.12all, ST=my.data$ST.0),1)
(table(H=my.data$Heroin.0, my.data$Abstinence.12all, ST=my.data$ST.0))
(table(H=my.data$Heroin.0, my.data$Abstinence.12all, ST=my.data$ST.0))[,,1]
8/21
chisq.test(table(H=my.data$Heroin.0, my.data$Abstinence.12all, ST=my.data$ST.0))[,,1]
chisq.test(table(H=my.data$Heroin.0, my.data$Abstinence.12all, ST=my.data$ST.0))[,,1])
chisq.test(table(H=my.data$Heroin.0, my.data$Abstinence.12all, ST=my.data$ST.0)[,,1])
chisq.test(table(H=my.data$Heroin.0, my.data$Abstinence.12all, ST=my.data$ST.0)[,,2])
(table(H=my.data$Heroin.0, my.data$Abstinence.12all, ST=my.data$ST.0))[,,2]
(table(H=my.data$Heroin.0, my.data$Abstinence.12all, ST=my.data$ST.0))
7/33
42/(42+77)
names(my.data)
summary(glm(Abstinence.12all~Heroin.0+Drugs.Other.0+ST.0+VirusHC+Mental, data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental, data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation, data=my.data, family="binomial"))
names(my.data)[1:20]
summary(glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+Mental.Mother, data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+Mental.Mother+Mental.Father, data=my.data, family="binomial"))
names(my.data)[1:20]
names(my.data)[1:30]
summary(glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness, data=my.data, family="binomial"))
names(my.data)[1:30]
summary(glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Sex.Harrass , data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Home.0+Mental+Sex.Harrass, data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0+Mental+Sex.Harrass, data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Phicho.Health , data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0 , data=my.data, family="binomial"))
summary(glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 , data=my.data, family="binomial"))
names(my.data)[1:30]
names(my.data)[1:50]
summary(glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0, data=my.data, family="binomial"))
names(my.data)[1:50]
summary(glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0, data=my.data, family="binomial"))
tmp=glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0, data=my.data, family="binomial")
step(tmp)
tmp=glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0+Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0+Mental+Sex.Harrass, data=my.data, family="binomial")
summary(tmp)
TMP=step(tmp)
summary(TMP)
names(my.data)
tmp=glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0+Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0+Mental+Sex.Harrass+Alcohol.0+Heroin.0+Coc.0+Thc.0+Bzo.0, data=my.data, family="binomial")
summary(tmp)
TMP=step(tmp)
summary(TMP)
tmp=glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0+Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0+Mental+Sex.Harrass+Alcohol.0+Heroin.0+Coc.0+Thc.0+Bzo.0+IV.0, data=my.data, family="binomial")
TMP=step(tmp)
summary(TMP)
names(my.data)
tmp=glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0+Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0+Mental+Sex.Harrass+Alcohol.0+Heroin.0+Coc.0+Thc.0+Bzo.0+IV.0+Nationality.OK, data=my.data, family="binomial")
TMP=step(tmp)
summary(TMP)
names(my.data)
table(my.data$Cure.Duration.Planned)
tmp=glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0+Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0+Mental+Sex.Harrass+Alcohol.0+Heroin.0+Coc.0+Thc.0+Bzo.0+IV.0+Nationality.OK+I(Cure.Duration.Planned<200), data=my.data, family="binomial")
TMP=step(tmp)
summary(TMP)
table(my.data$Cure.Duration.Planned)
tmp=glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0+Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0+Mental+Sex.Harrass+Alcohol.0+Heroin.0+Coc.0+Thc.0+Bzo.0+IV.0+Nationality.OK+I(Cure.Duration.Planned<278), data=my.data, family="binomial")
TMP=step(tmp)
names(my.data)
Cu
tmp=glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0+Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0+Mental+Sex.Harrass+Alcohol.0+Heroin.0+Coc.0+Thc.0+Bzo.0+IV.0+Nationality.OK+I(Cure.Duration.Planned<278)+Cure.Finished, data=my.data, family="binomial")
TMP=step(tmp)
summary(TMP)
? step
Cu
tmp=glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0+Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0+Mental+Sex.Harrass+Alcohol.0+Heroin.0+Coc.0+Thc.0+Bzo.0+IV.0+Nationality.OK+I(Cure.Duration.Planned<278)+Cure.Finished, data=my.data, family="binomial")
TMP=step(tmp, direction="forward"
)
my.data$Cure.Duration.Planned
table(my.data$Cure.Duration.Planned)
cumsum(table(my.data$Cure.Duration.Planned))
tmp=coxph(Surv(Abstinence.Time, Abstinence.Event)~Abstinence.0, data=my.data, family="binomial")
summary(tmp)
tmp=coxph(Surv(Abstinence.Time, Abstinence.Event)~Abstinence.0, data=my.data, family="binomial")
summary(tmp)
tmp=coxph(Surv(Abstinence.Time, Abstinence.Event)~Abstinence.0, data=my.data)
summary(tmp)
my.data$Abstinence.12all
my.data$Abstinence.12
my.data$Abstinence.3
my.data[,c(35, 46, 61, 144, 72)]
my.filename="Odvisnost_data14b.txt"
my.datadir="C:/Users/Lara/Dropbox/Odvisnost/data"
my.data=read.delim(file.path(my.datadir, my.filename), sep="\t", skip=3)
my.data=my.data[,-1]
summary(my.data)
my.data$Abstinence.12all
my.data=my.data[-c(193:197),]
my.data$Abstinence.12all
The data set contained summary(glm(Abstinence.12all ~ M.motivation + C.external + R.readiness, data = my.data,
family = "binomial"))
summary(glm(Abstinence.12all ~ M.motivation + C.external + R.readiness, data = my.data,
family = "binomial"))
summary(glm(Abstinence.12all ~ M.motivation, data = my.data,
family = "binomial"))
summary(glm(Abstinence.12all ~ rcs(M.motivation), data = my.data,
family = "binomial"))
anova(glm(Abstinence.12all ~ rcs(M.motivation), data = my.data,
family = "binomial"))
anova(glm(Abstinence.12all ~ rcs(M.motivation), data = my.data,
family = "binomial"), test= "Chi")
tmp=glm(Abstinence.12all ~ rcs(M.motivation), data = my.data,
family = "binomial", x=T,y=Y))
tmp=glm(Abstinence.12all ~ rcs(M.motivation), data = my.data,
family = "binomial", x=T,y=T))
tmp=glm(Abstinence.12all ~ rcs(M.motivation), data = my.data,
family = "binomial", x=T,y=T)
plot(tmp$x[,2], tmp$fitted)
? ste[]
? step
TMP=step(tmp, direction="both")
tmp=glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0+Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0+Sex.Harrass+Alcohol.0+Heroin.0+Coc.0+Thc.0+Bzo.0+IV.0+Nationality.OK+I(Cure.Duration.Planned<278), data=my.data, family="binomial")
TMP=step(tmp, direction="both")
source('C:/Users/lara/Dropbox/odvisnost/scripts/import.r')
tmp=glm(Abstinence.12all~Abstinence.0+ST.0+VirusHC+Mental+M.motivation+C.external+R.readiness+Psicho.Health.0+Phisic.Health.0 +Criminal.0+QoL.0+Age+Sex+HighSchool+Children+LivesWithDep+Work.0+Living.0+Sex.Harrass+Alcohol.0+Heroin.0+Coc.0+Thc.0+Bzo.0+IV.0+Nationality.OK+I(Cure.Duration.Planned<278), data=my.data, family="binomial")
TMP=step(tmp, direction="both")
summary(TMP)
my.data[,c(35, 46, 61, 144, 72)]
my.data[,c(35, 46, 61, 144, 72)][my.data[,72]=="Yes"]
my.data[,c(35, 46, 61, 144, 72)][my.data[,72]=="Yes",]
my.data[,c(35, 46, 61, 144, 72)][my.data[,72]=="No",]
my.data[,c(35, 46, 61, 144, 72)][my.data[,72]=="No",2:4]
apply(my.data[,c(35, 46, 61, 144, 72)][my.data[,72]=="No",2:4], 1, function(x) sum(x=="Yes"))
table(apply(my.data[,c(35, 46, 61, 144, 72)][my.data[,72]=="No",2:4], 1, function(x) sum(x=="Yes")))
library(penalized)
num.samples=100
beta1=1
alpha=0
lp=alpha+beta1*rnorm(num.samples)
my.p=exp(lp)/(1+exp(lp))
my.u=runif(num.samples)
my.y=ifelse(my.u<my.u, 1, 0)
table(my.y)
my.u
num.samples=100
beta1=1
alpha=0
lp=alpha+beta1*rnorm(num.samples)
my.p=exp(lp)/(1+exp(lp))
my.u=runif(num.samples)
my.y=ifelse(my.u<my.p, 1, 0)
my.y
table(my.y)
num.sim=1000
num.samples=100
beta1=1
alpha=0
my.x=rnorm(num.samples)
lp=alpha+beta1*
my.p=exp(lp)/(1+exp(lp))
my.u=runif(num.samples)
my.y=ifelse(my.u<my.p, 1, 0)
my.mod=vector("list", num.sim)
for(i in 1:num.sim)
my.mod[[i]]=glm(my.y~ my.x, family="binomial")
num.sim=1000
num.samples=100
beta1=1
alpha=0
my.mod=vector("list", num.sim)
for(i in 1:num.sim){
my.x=rnorm(num.samples)
lp=alpha+beta1*my.x
my.p=exp(lp)/(1+exp(lp))
my.u=runif(num.samples)
my.y=ifelse(my.u<my.p, 1, 0)
my.mod[[i]]=glm(my.y~ my.x, family="binomial")
}
lapply(my.mod, function(x) x$coef)
unlist(lapply(my.mod, function(x) x$coef[1]))
my.alpha=as.numeric(unlist(lapply(my.mod, function(x) x$coef[1])))
my.beta=as.numeric(unlist(lapply(my.mod, function(x) x$coef[2])))
my.beta
summary(my.beta)
summary(my.alpha)
setwd("C:\\Users\\lara\\Dropbox\\medplot\\ISCB2014\\example")
runApp()
library(shiny)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
binom(0, 15, 0.5)
dbinom(0, 15, 0.5)
dbinom(0, 4, 0.5)
dbinom(0, 20, 0.5)
0.0000009
dbinom(0, 10, 0.5)
? builder
library(shiny)
? builder
setwd("E:\\Dropbox (MF Uni LJ)\\didatticaStat\\magStat\\AdvancedR\\Lect2ShinyApps\\exercises\\exercise1AllTest")
runApp()
setwd("E:\\Dropbox (MF Uni LJ)\\didatticaStat\\magStat\\AdvancedR\\Lect2ShinyApps\\exercises\\exercise2.5")
runApp()
