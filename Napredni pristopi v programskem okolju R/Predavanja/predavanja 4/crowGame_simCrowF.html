<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<style type="text/css">
.knitr .inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage .left {
  text-align: left;
}
.rimage .right {
  text-align: right;
}
.rimage .center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <script src="Datoteke_za_crowGame_simCrowF/center-images.js"></script>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="https://yihui.name/knitr/"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.20</code>)
    .</p>

<div class="chunk" id="auto-report"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">#num.fruits &lt;- 4 #pieces of fruit of each type</span>
<span class="hl com">#type.fruits &lt;- 4 #number of types of fruit</span>
<span class="hl com">#crow.steps &lt;- 6 # number of steps the crow makes before winning</span>


<span class="hl std">sim.crow</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">num.fruits</span> <span class="hl std">=</span> <span class="hl num">4</span><span class="hl std">,</span>
                     <span class="hl kwc">type.fruits</span> <span class="hl std">=</span> <span class="hl num">4</span><span class="hl std">,</span>
                     <span class="hl kwc">crow.steps</span> <span class="hl std">=</span> <span class="hl num">6</span><span class="hl std">) {</span>

  <span class="hl com">#function for the basic game - First Orchard - My very first games Haba </span>
  <span class="hl com">#strategy used when the basket is the die outcome: pick the fruit with most pieces left</span>
  <span class="hl com">#num.fruits  : pieces of fruit of each type</span>
  <span class="hl com">#type.fruits : number of types of fruit</span>
  <span class="hl com">#crow.steps  : number of steps the crow makes before winning</span>

  <span class="hl std">num.rolls</span> <span class="hl kwb">&lt;-</span>
    <span class="hl num">0</span> <span class="hl com">#how many rolls to finish the game, initialize  to 0</span>

  <span class="hl std">fruit</span> <span class="hl kwb">&lt;-</span>
    <span class="hl kwd">rep</span><span class="hl std">(num.fruits, type.fruits)</span> <span class="hl com">#vector that contains the number of fruits left for each type of fruit</span>
  <span class="hl com">#lenght: type.fruits, each element is equal to num.fruit at the beginning of the game</span>
  <span class="hl com">#example using defalts: c(4,4,4,4)</span>

  <span class="hl std">roll.collect</span> <span class="hl kwb">&lt;-</span>
    <span class="hl kwa">NULL</span> <span class="hl com">#for debugging pruporses: saves the complete history of rolls</span>

  <span class="hl com">#the game ends if all the fruit was collected (sum(fruit)==0) or if the crow does not have any steps left (crow.step==0)</span>
  <span class="hl kwa">while</span> <span class="hl std">(</span><span class="hl kwd">sum</span><span class="hl std">(fruit)</span> <span class="hl opt">&gt;</span> <span class="hl num">0</span> <span class="hl opt">&amp;</span> <span class="hl std">crow.steps</span> <span class="hl opt">&gt;</span> <span class="hl num">0</span><span class="hl std">) {</span>
    <span class="hl std">roll</span> <span class="hl kwb">&lt;-</span>
      <span class="hl kwd">sample</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">6</span><span class="hl std">,</span> <span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">)</span> <span class="hl com">#roll the die once, 1 outcome in the range 1-6, for convenience 1:type.fruits are colors, type.fruits+1 is</span>
    <span class="hl std">num.rolls</span> <span class="hl kwb">&lt;-</span>
      <span class="hl std">num.rolls</span> <span class="hl opt">+</span> <span class="hl num">1</span> <span class="hl com">#increase the counter of the number of rolls</span>
    <span class="hl std">roll.collect</span> <span class="hl kwb">&lt;-</span>
      <span class="hl kwd">c</span><span class="hl std">(roll.collect, roll)</span> <span class="hl com">#saving the history of the rolls</span>

    <span class="hl kwa">if</span> <span class="hl std">(roll</span> <span class="hl opt">&lt;=</span> <span class="hl std">type.fruits) {</span>
      <span class="hl com">#color outcome is one type of fruit</span>
      <span class="hl kwa">if</span> <span class="hl std">(fruit[roll]</span> <span class="hl opt">==</span> <span class="hl num">0</span><span class="hl std">)</span>
        <span class="hl kwa">next</span>  <span class="hl com">#not collecting fruit if the type of fruit obtained with the die is finished</span>
      <span class="hl std">fruit[roll]</span> <span class="hl kwb">&lt;-</span> <span class="hl std">fruit[roll]</span> <span class="hl opt">-</span> <span class="hl num">1</span> <span class="hl com">#else collect a piece of fruit</span>

    <span class="hl std">}</span> <span class="hl kwa">else</span>
      <span class="hl kwa">if</span> <span class="hl std">(roll</span> <span class="hl opt">==</span> <span class="hl std">type.fruits</span> <span class="hl opt">+</span> <span class="hl num">1</span><span class="hl std">) {</span>
        <span class="hl com">#basket outcome</span>
        <span class="hl com">#browser()</span>
        <span class="hl std">max.fruit</span> <span class="hl kwb">&lt;-</span>
          <span class="hl kwd">which.max</span><span class="hl std">(fruit)</span> <span class="hl com">#check which type of fruit has maximum number of pieces left, there might be ties</span>
        <span class="hl std">fruit[max.fruit]</span> <span class="hl kwb">&lt;-</span>
          <span class="hl std">fruit[max.fruit]</span> <span class="hl opt">-</span> <span class="hl num">1</span> <span class="hl com">#collect a piece of the type with max number of pieces</span>
      <span class="hl std">}</span><span class="hl com">#end basket outcome</span>
    <span class="hl kwa">else</span> <span class="hl std">{</span>
      <span class="hl com">#if(roll==type.fruits+2)</span>
      <span class="hl std">crow.steps</span> <span class="hl kwb">&lt;-</span>
        <span class="hl std">crow.steps</span> <span class="hl opt">-</span> <span class="hl num">1</span> <span class="hl com">#crow outcome, make one step forward</span>
    <span class="hl std">}</span>

  <span class="hl std">}</span><span class="hl com">#end while</span>


  <span class="hl com">#output of the function, must be one element - multiple results can be passed using a list</span>
  <span class="hl com">#winner: who wins, rolls: in how many rolls, #history of each game</span>
  <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">list</span><span class="hl std">(</span>
    <span class="hl kwc">winner</span> <span class="hl std">=</span> <span class="hl kwd">ifelse</span><span class="hl std">(crow.steps</span> <span class="hl opt">&gt;</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl str">"You"</span><span class="hl std">,</span> <span class="hl str">"Crow"</span><span class="hl std">),</span>
    <span class="hl kwc">rolls</span> <span class="hl std">= num.rolls,</span>
    <span class="hl kwc">roll.collect</span> <span class="hl std">= roll.collect</span>
  <span class="hl std">))</span>
<span class="hl std">}</span><span class="hl com">#end sim.crow</span>

<span class="hl kwd">set.seed</span><span class="hl std">(</span><span class="hl num">1234</span><span class="hl std">)</span>
<span class="hl std">tmp</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">replicate</span><span class="hl std">(</span><span class="hl num">10000</span><span class="hl std">,</span> <span class="hl kwd">sim.crow</span><span class="hl std">())</span>

<span class="hl kwd">table</span><span class="hl std">(</span><span class="hl kwd">unlist</span><span class="hl std">(tmp[</span><span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwd">length</span><span class="hl std">(tmp),</span> <span class="hl kwc">by</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">)]))</span> <span class="hl com">#winning history</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## Crow  You 
## 2303 7697
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">summary</span><span class="hl std">(</span><span class="hl kwd">unlist</span><span class="hl std">(tmp[</span><span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">2</span><span class="hl std">,</span> <span class="hl kwd">length</span><span class="hl std">(tmp),</span> <span class="hl kwc">by</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">)]))</span> <span class="hl com">#number of rolls</span>
</pre></div>
<div class="output"><pre class="knitr r">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    7.00   20.00   22.00   22.26   24.00   49.00
</pre></div>
</div></div>

  <p>The R session information (including the OS info, R version and all
    packages used):</p>

<div class="chunk" id="session-info"><div class="rcode"><div class="source"><pre class="knitr r">    <span class="hl kwd">sessionInfo</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## R version 3.5.1 (2018-07-02)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 7 x64 (build 7601) Service Pack 1
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=Slovenian_Slovenia.1250  LC_CTYPE=Slovenian_Slovenia.1250   
## [3] LC_MONETARY=Slovenian_Slovenia.1250 LC_NUMERIC=C                       
## [5] LC_TIME=Slovenian_Slovenia.1250    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] knitr_1.20           microbenchmark_1.4-7
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.1       codetools_0.2-15 lattice_0.20-35  mvtnorm_1.0-8    zoo_1.8-4       
##  [6] MASS_7.3-50      grid_3.5.1       plyr_1.8.4       magrittr_1.5     evaluate_0.12   
## [11] pROC_1.14.0      highr_0.7        stringi_1.1.7    multcomp_1.4-8   Matrix_1.2-14   
## [16] sandwich_2.5-0   splines_3.5.1    TH.data_1.0-9    tools_3.5.1      stringr_1.3.1   
## [21] yaml_2.2.0       survival_2.42-6  compiler_3.5.1
</pre></div>
<div class="source"><pre class="knitr r">    <span class="hl kwd">Sys.time</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] "2019-11-04 12:39:01 CET"
</pre></div>
</div></div>




</body></html>