geom_vline(data=mean_mu,
aes(xintercept=mean_mu_value, color="blue")) +
facet_wrap(vars(group),
ncol=2,
scales="fixed") +
labs(x=expression(mu[j]),
y="Gostota",
title=expression(paste("Grafi gostote za ",
mu[j],
" s 95% intervalom zaupanja")),
subtitle="j = 2, 8, 9, 42;
Modri črti - interval zaupanja;
Rdeča črta - povprečje")
sig_data
hyper_data
lwr_upr_mu <- mu_data %>%
group_by(group) %>%
nest() %>%
mutate(
ret = map(data, ~quantile(.$mu, probs=c(0.025, 0.975))),
ret = invoke_map(tibble, ret)
) %>%
unnest(ret)
mean_mu <- mu_data %>%
group_by(group) %>%
summarise(mean_mu_value = mean(mu))
lwr_upr_sig <- sig_data %>%
group_by(group) %>%
nest() %>%
mutate(
ret = map(data, ~quantile(.$sigma, probs=c(0.025, 0.975))),
ret = invoke_map(tibble, ret)
) %>%
unnest(ret)
mean_sig <- sig_data %>%
group_by(group) %>%
summarise(mean_sig_value = mean(sigma))
lwr_upr_hyp <- hyper_data %>%
group_by(vars_) %>%
nest() %>%
mutate(
ret = map(data, ~quantile(.$value, probs=c(0.025, 0.975))),
ret = invoke_map(tibble, ret)
) %>%
unnest(ret)
mean_hyp <- hyper_data %>%
group_by(group) %>%
summarise(mean_hyp_value = mean(value))
lwr_upr_mu <- mu_data %>%
group_by(group) %>%
nest() %>%
mutate(
ret = map(data, ~quantile(.$mu, probs=c(0.025, 0.975))),
ret = invoke_map(tibble, ret)
) %>%
unnest(ret)
mean_mu <- mu_data %>%
group_by(group) %>%
summarise(mean_mu_value = mean(mu))
lwr_upr_sig <- sig_data %>%
group_by(group) %>%
nest() %>%
mutate(
ret = map(data, ~quantile(.$sigma, probs=c(0.025, 0.975))),
ret = invoke_map(tibble, ret)
) %>%
unnest(ret)
mean_sig <- sig_data %>%
group_by(group) %>%
summarise(mean_sig_value = mean(sigma))
lwr_upr_hyp <- hyper_data %>%
group_by(vars_) %>%
nest() %>%
mutate(
ret = map(data, ~quantile(.$value, probs=c(0.025, 0.975))),
ret = invoke_map(tibble, ret)
) %>%
unnest(ret)
mean_hyp <- hyper_data %>%
group_by(vars_) %>%
summarise(mean_hyp_value = mean(value))
ggplot(sig_data, aes(x=sigma)) +
geom_density() +
geom_vline(data=lwr_upr_sig,
aes(xintercept=`2.5%`, color="red"), # somehow setting to default blue
linetype="longdash") +
geom_vline(data=lwr_upr_sig,
aes(xintercept=`97.5%`, color="red"),
linetype="longdash") +
geom_vline(data=mean_sig,
aes(xintercept=mean_mu_value, color="blue")) + # as this is second it's red
facet_wrap(vars(group),
ncol=2,
scales="fixed") +
labs(x=expression(sig[j]^2),
y="Gostota",
title=expression(paste("Grafi gostote za ",
sig[j]^2,
" s 95% intervalom zaupanja")),
subtitle="j = 2, 8, 9, 42;
Modri črti - interval zaupanja;
Rdeča črta - povprečje")
ggplot(sig_data, aes(x=sigma)) +
geom_density() +
geom_vline(data=lwr_upr_sig,
aes(xintercept=`2.5%`, color="red"), # somehow setting to default blue
linetype="longdash") +
geom_vline(data=lwr_upr_sig,
aes(xintercept=`97.5%`, color="red"),
linetype="longdash") +
geom_vline(data=mean_sig,
aes(xintercept=mean_sig_value, color="blue")) + # as this is second it's red
facet_wrap(vars(group),
ncol=2,
scales="fixed") +
labs(x=expression(sig[j]^2),
y="Gostota",
title=expression(paste("Grafi gostote za ",
sig[j]^2,
" s 95% intervalom zaupanja")),
subtitle="j = 2, 8, 9, 42;
Modri črti - interval zaupanja;
Rdeča črta - povprečje")
ggplot(sig_data, aes(x=sigma)) +
geom_density() +
geom_vline(data=lwr_upr_sig,
aes(xintercept=`2.5%`, color="red"), # somehow setting to default blue
linetype="longdash") +
geom_vline(data=lwr_upr_sig,
aes(xintercept=`97.5%`, color="red"),
linetype="longdash") +
geom_vline(data=mean_sig,
aes(xintercept=mean_sig_value, color="blue")) + # as this is second it's red +
geom_vline(data=mean_sig,
aes(xintercept=med_sig_value, color="green")) + # as this is second it's red
facet_wrap(vars(group),
ncol=2,
scales="fixed") +
labs(x=expression(sig[j]^2),
y="Gostota",
title=expression(paste("Grafi gostote za ",
sig[j]^2,
" s 95% intervalom zaupanja")),
subtitle="j = 2, 8, 9, 42;
Modri črti - interval zaupanja;
Rdeča črta - povprečje")
mean_sig <- sig_data %>%
group_by(group) %>%
summarise(mean_sig_value = mean(sigma),
med_sig_value = median(sigma))
ggplot(sig_data, aes(x=sigma)) +
geom_density() +
geom_vline(data=lwr_upr_sig,
aes(xintercept=`2.5%`, color="red"), # somehow setting to default blue
linetype="longdash") +
geom_vline(data=lwr_upr_sig,
aes(xintercept=`97.5%`, color="red"),
linetype="longdash") +
geom_vline(data=mean_sig,
aes(xintercept=mean_sig_value, color="blue")) + # as this is second it's red +
geom_vline(data=mean_sig,
aes(xintercept=med_sig_value, color="green")) + # as this is second it's red
facet_wrap(vars(group),
ncol=2,
scales="fixed") +
labs(x=expression(sig[j]^2),
y="Gostota",
title=expression(paste("Grafi gostote za ",
sig[j]^2,
" s 95% intervalom zaupanja")),
subtitle="j = 2, 8, 9, 42;
Modri črti - interval zaupanja;
Rdeča črta - povprečje")
HPDinterval(eta2.all)
HPDinterval(mu.all)
?HPDinterval
data(line)
HPDinterval(line)
data(line)
line
data(line)
HPDinterval(line)
HPDinterval(data.frame(mu=mu.all))
HPDinterval(list(mu=mu.all))
??HPDI
install.packages("rethinking")
HPDinterval(as.mcmc(mu.all))
lwr_upr_hyp
HPDinterval(as.mcmc(sigma20.all))
HPDinterval(as.mcmc(eta2.all))
HPDinterval(as.mcmc(nu0.all))
ggplot(hyper_data, aes(x=value)) +
geom_density() +
facet_wrap(~vars_,
scales="free",
ncol=2,
labeller=label_parsed) +
geom_bar(data = subset(hyper_data, vars_=="nu[0]"),
width=0.3)
ggplot(hyper_data, aes(x=value)) +
geom_density() +
facet_wrap(~vars_,
scales="free",
ncol=2,
labeller=label_parsed) +
geom_bar(mapping=aes(y=..density..),
data = subset(hyper_data, vars_=="nu[0]"),
width=0.3)
ggplot(hyper_data, aes(x=value)) +
geom_density() +
facet_wrap(~vars_,
scales="free",
ncol=2,
labeller=label_parsed) +
geom_bar(stat="bin",
aes(y=..density..),
data = subset(hyper_data, vars_=="nu[0]"),
width=0.3)
ggplot(hyper_data, aes(x=value)) +
geom_density() +
facet_wrap(~vars_,
scales="free",
ncol=2,
labeller=label_parsed) +
geom_bar(stat="bin",
aes(y=..density..),
data = subset(hyper_data, vars_=="nu[0]"))
ggplot(hyper_data, aes(x=value)) +
geom_density() +
facet_wrap(~vars_,
scales="free",
ncol=2,
labeller=label_parsed) +
geom_bar(stat="bar",
aes(y=..density..),
data = subset(hyper_data, vars_=="nu[0]"))
ggplot(hyper_data, aes(x=value)) +
geom_density() +
facet_wrap(~vars_,
scales="free",
ncol=2,
labeller=label_parsed) +
geom_bar(aes(y=..density..),
data = subset(hyper_data, vars_=="nu[0]"),
width=0.3)
ggplot(hyper_data, aes(x=value,y=..density..)) +
geom_density() +
facet_wrap(~vars_,
scales="free",
ncol=2,
labeller=label_parsed) +
geom_bar(data = subset(hyper_data, vars_=="nu[0]"),
width=0.3)
ggplot(hyper_data, aes(x=value)) +
geom_density() +
facet_wrap(~vars_,
scales="free",
ncol=2,
labeller=label_parsed) +
geom_bar(data = subset(hyper_data, vars_=="nu[0]"),
width=0.3)
ggplot(hyper_data, aes(x=value)) +
geom_density() +
geom_vline(data=lwr_upr_hyp,
aes(xintercept=`2.5%`, color="red"), # somehow setting to default blue
linetype="longdash") +
geom_vline(data=lwr_upr_hyp,
aes(xintercept=`97.5%`, color="red"),
linetype="longdash") +
geom_vline(data=mean_hyp,
aes(xintercept=mean_hyp_value, color="blue")) + # as this is second it's red
facet_wrap(~vars_,
scales="free",
ncol=2,
labeller=label_parsed) +
geom_bar(data = subset(hyper_data, vars_=="nu[0]"),
width=0.3)
ggplot(hyper_data, aes(x=value)) +
geom_density() +
geom_vline(data=lwr_upr_hyp,
aes(xintercept=`2.5%`, color="red"), # somehow setting to default blue
linetype="longdash") +
geom_vline(data=lwr_upr_hyp,
aes(xintercept=`97.5%`, color="red"),
linetype="longdash") +
geom_vline(data=mean_hyp,
aes(xintercept=mean_hyp_value, color="blue")) + # as this is second it's red
facet_wrap(~vars_,
scales="free",
ncol=2,
labeller=label_parsed) +
geom_bar(data = subset(hyper_data, vars_=="nu[0]"),
width=0.3) +
labs(x="Vrednost parametra",
y="Gostota",
title=expression(paste("Grafi gostote za preostale parametre s 95% intervalom zaupanja")),
subtitle="Modri črti - interval zaupanja;
Rdeča črta - povprečje;
Zelena črta - mediana")
ggplot(hyper_data, aes(x=value)) +
geom_density() +
geom_vline(data=lwr_upr_hyp,
aes(xintercept=`2.5%`, color="red"), # somehow setting to default blue
linetype="longdash") +
geom_vline(data=lwr_upr_hyp,
aes(xintercept=`97.5%`, color="red"),
linetype="longdash") +
geom_vline(data=mean_hyp,
aes(xintercept=mean_hyp_value, color="blue")) + # as this is second it's red
facet_wrap(~vars_,
scales="free",
ncol=2,
labeller=label_parsed) +
geom_bar(data = subset(hyper_data, vars_=="nu[0]"),
width=0.3) +
labs(x="Vrednost parametra",
y="Gostota",
title=expression(paste("Grafi gostote za preostale parametre s 95% intervalom zaupanja")),
subtitle="Modri črti - interval zaupanja;
Rdeča črta - povprečje")
mean_hyp <- hyper_data %>%
group_by(vars_) %>%
summarise(mean_hyp_value = mean(value),
med_hyp_value = median(value))
mean_hyp
mean_sig
mean_mu
mean_mu <- mu_data %>%
group_by(group) %>%
summarise(mean_mu_value=mean(mu),
med_mu_value=median(mu))
lwr_upr_sig <- sig_data %>%
group_by(group) %>%
nest() %>%
mutate(
ret = map(data, ~quantile(.$sigma, probs=c(0.025, 0.975))),
ret = invoke_map(tibble, ret)
) %>%
unnest(ret)
lwr_upr_sig
lwr_upr_mu %>% mutate(word=paste0("mu", group))
mean_sig
lwr_upr_hyp %>% mutate(word=paste0("mu", group)) %>%
select(word, `2.5%`, `97.5%`)
lwr_upr_hyp
lwr_upr_mu %>% mutate("(hiper)parameter"=paste0("mu_", group)) %>%
select("(hiper)parameter", `2.5%`, `97.5%`)
lwr_upr_mu %>% mutate("(hiper)parameter"=paste0("mu_", group)) %>%
select("(hiper)parameter", `2.5%`, `97.5%`)
lwr_upr_mu %>% mutate("(hiper)parameter"=paste0("mu_", group)) %>%
select(`(hiper)parameter`, `2.5%`, `97.5%`)
lwr_upr_mu %>% ungroup() %>%
mutate("(hiper)parameter"=paste0("mu_", group)) %>%
select(`(hiper)parameter`, `2.5%`, `97.5%`)
?rename_at
mean_mu
mean_sig
mean_hyp
lwr_upr_hyp %>% select(vars_, `2.5%`, `97.5%`) %>%
rename(`(hiper)parameter`=vars_)
mean_mu
mean_mu %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("mu[", group, "]")) %>%
select(`(hiper)parameter`, med_mu_value)
mean_hyp
lwr_upr_hyp %>% select(vars_, `2.5%`, `97.5%`) %>%
rename(`(hiper)parameter`=vars_)
mean_sig %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("sig[", group, "]^2")) %>%
select(`(hiper)parameter`, med_sig_value)
lwr_upr_mu %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("mu[", group, "]")) %>%
select(`(hiper)parameter`, `2.5%`, `97.5%`)
lwr_upr_sig %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("sig[", group, "]^2")) %>%
select(`(hiper)parameter`, `2.5%`, `97.5%`)
lwr_upr_hyp %>%
ungroup() %>%
select(vars_, `2.5%`, `97.5%`) %>%
rename(`(hiper)parameter`=vars_)
mean_mu %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("mu[", group, "]")) %>%
select(`(hiper)parameter`, med_mu_value) %>%
rename(Mediana=med_mu_value)
mean_sig %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("sig[", group, "]^2")) %>%
select(`(hiper)parameter`, med_sig_value) %>%
rename(Mediana=med_sig_value)
mean_hyp %>%
ungroup() %>%
select(vars_, med_hyp_value) %>%
rename(`(hiper)parameter`=vars_,
Mediana=med_hyp_value)
lwr_upr_mu <- lwr_upr_mu %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("mu[", group, "]")) %>%
select(`(hiper)parameter`, `2.5%`, `97.5%`)
lwr_upr_sig <- lwr_upr_sig %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("sig[", group, "]^2")) %>%
select(`(hiper)parameter`, `2.5%`, `97.5%`)
lwr_upr_hyp <- lwr_upr_hyp %>%
ungroup() %>%
select(vars_, `2.5%`, `97.5%`) %>%
rename(`(hiper)parameter`=vars_)
mean_mu <- mean_mu %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("mu[", group, "]")) %>%
select(`(hiper)parameter`, med_mu_value) %>%
rename(Mediana=med_mu_value)
mean_sig <- mean_sig %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("sig[", group, "]^2")) %>%
select(`(hiper)parameter`, med_sig_value) %>%
rename(Mediana=med_sig_value)
mean_hyp <- mean_hyp %>%
ungroup() %>%
select(vars_, med_hyp_value) %>%
rename(`(hiper)parameter`=vars_,
Mediana=med_hyp_value)
mu_tbl <- left_join(lwr_upr_mu, mean_mu)
mu_tbl
mu_tbl %>% select(`(hiper)parameter`, `2.5%`, Mediana, `97.5%`)
rbind(mu_tbl, sig_tbl, hyp_tbl)
mu_tbl <- left_join(lwr_upr_mu, mean_mu, by=c("(hiper)parameter")) %>%
select(`(hiper)parameter`, `2.5%`, Mediana, `97.5%`)
sig_tbl <- left_join(lwr_upr_sig, mean_sig, by=c("(hiper)parameter")) %>%
select(`(hiper)parameter`, `2.5%`, Mediana, `97.5%`)
hyp_tbl <- left_join(lwr_upr_hyp, mean_hyp, by=c("(hiper)parameter")) %>%
select(`(hiper)parameter`, `2.5%`, Mediana, `97.5%`)
rbind(mu_tbl, sig_tbl, hyp_tbl)
lwr_upr_mu <- lwr_upr_mu %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("$\\mu_", group)) %>%
select(`(hiper)parameter`, `2.5%`, `97.5%`)
lwr_upr_sig <- lwr_upr_sig %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("$\\sig_", group, "^2")) %>%
select(`(hiper)parameter`, `2.5%`, `97.5%`)
lwr_upr_hyp <- lwr_upr_hyp %>%
ungroup() %>%
select(vars_, `2.5%`, `97.5%`) %>%
rename(`(hiper)parameter`=vars_)
mean_mu <- mean_mu %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("$\\mu_", group)) %>%
select(`(hiper)parameter`, med_mu_value) %>%
rename(Mediana=med_mu_value)
mean_sig <- mean_sig %>%
ungroup() %>%
mutate("(hiper)parameter"=paste0("$\\sig_", group, "^2")) %>%
select(`(hiper)parameter`, med_sig_value) %>%
rename(Mediana=med_sig_value)
mean_hyp <- mean_hyp %>%
ungroup() %>%
select(vars_, med_hyp_value) %>%
rename(`(hiper)parameter`=vars_,
Mediana=med_hyp_value)
mu_tbl <- left_join(lwr_upr_mu, mean_mu, by=c("(hiper)parameter")) %>%
select(`(hiper)parameter`, `2.5%`, Mediana, `97.5%`)
sig_tbl <- left_join(lwr_upr_sig, mean_sig, by=c("(hiper)parameter")) %>%
select(`(hiper)parameter`, `2.5%`, Mediana, `97.5%`)
hyp_tbl <- left_join(lwr_upr_hyp, mean_hyp, by=c("(hiper)parameter")) %>%
select(`(hiper)parameter`, `2.5%`, Mediana, `97.5%`)
rbind(mu_tbl, sig_tbl, hyp_tbl)
lwr_upr_mu <- mu_data %>%
group_by(group) %>%
nest() %>%
mutate(
ret = map(data, ~quantile(.$mu, probs=c(0.025, 0.975))),
ret = invoke_map(tibble, ret)
) %>%
unnest(ret)
mean_mu <- mu_data %>%
group_by(group) %>%
summarise(mean_mu_value=mean(mu),
med_mu_value=median(mu))
lwr_upr_sig <- sig_data %>%
group_by(group) %>%
nest() %>%
mutate(
ret = map(data, ~quantile(.$sigma, probs=c(0.025, 0.975))),
ret = invoke_map(tibble, ret)
) %>%
unnest(ret)
mean_sig <- sig_data %>%
group_by(group) %>%
summarise(mean_sig_value=mean(sigma),
med_sig_value=median(sigma))
lwr_upr_hyp <- hyper_data %>%
group_by(vars_) %>%
nest() %>%
mutate(
ret = map(data, ~quantile(.$value, probs=c(0.025, 0.975))),
ret = invoke_map(tibble, ret)
) %>%
unnest(ret)
mean_hyp <- hyper_data %>%
group_by(vars_) %>%
summarise(mean_hyp_value=mean(value),
med_hyp_value=median(value))
lwr_upr_hyp
hyp_tbl
hyp_tbl$`(hiper)parameter` <- c("$\\mu$", "$\\sigma_0^2$", "$\\eta^2$", "$\\nu_0$")
hyp_tbl
?kable
